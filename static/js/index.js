window.HELP_IMPROVE_VIDEOJS = false;

var result_data = [
    {
        "question": 1,
        "o3-mini": 100.0,
        "o1": 100.0,
        "DeepSeek-R1": 100.0,
        "DeepSeek-R1-Distill-Qwen-14B": 100.0,
        "DeepSeek-R1-Distill-Llama-70B": 100.0,
        "DeepSeek-R1-Distill-Qwen-1.5B": 100.0,
        "gpt-4o": 100.0,
        "claude-3.5-sonnet": 25.0
    },
    {
        "question": 2,
        "o3-mini": 100.0,
        "o1": 100.0,
        "DeepSeek-R1": 100.0,
        "DeepSeek-R1-Distill-Qwen-14B": 50.0,
        "DeepSeek-R1-Distill-Llama-70B": 50.0,
        "DeepSeek-R1-Distill-Qwen-1.5B": 0.0,
        "gpt-4o": 0.0,
        "claude-3.5-sonnet": 0.0
    },
    {
        "question": 3,
        "o3-mini": 100.0,
        "o1": 100.0,
        "DeepSeek-R1": 100.0,
        "DeepSeek-R1-Distill-Qwen-14B": 100.0,
        "DeepSeek-R1-Distill-Llama-70B": 100.0,
        "DeepSeek-R1-Distill-Qwen-1.5B": 100.0,
        "gpt-4o": 25.0,
        "claude-3.5-sonnet": 0.0
    },
    {
        "question": 4,
        "o3-mini": 100.0,
        "o1": 100.0,
        "DeepSeek-R1": 100.0,
        "DeepSeek-R1-Distill-Qwen-14B": 100.0,
        "DeepSeek-R1-Distill-Llama-70B": 100.0,
        "DeepSeek-R1-Distill-Qwen-1.5B": 25.0,
        "gpt-4o": 0.0,
        "claude-3.5-sonnet": 0.0
    },
    {
        "question": 5,
        "o3-mini": 75.0,
        "o1": 100.0,
        "DeepSeek-R1": 100.0,
        "DeepSeek-R1-Distill-Qwen-14B": 100.0,
        "DeepSeek-R1-Distill-Llama-70B": 75.0,
        "DeepSeek-R1-Distill-Qwen-1.5B": 0.0,
        "gpt-4o": 0.0,
        "claude-3.5-sonnet": 0.0
    },
    {
        "question": 6,
        "o3-mini": 100.0,
        "o1": 100.0,
        "DeepSeek-R1": 100.0,
        "DeepSeek-R1-Distill-Qwen-14B": 100.0,
        "DeepSeek-R1-Distill-Llama-70B": 100.0,
        "DeepSeek-R1-Distill-Qwen-1.5B": 100.0,
        "gpt-4o": 0.0,
        "claude-3.5-sonnet": 0.0
    },
    {
        "question": 7,
        "o3-mini": 100.0,
        "o1": 75.0,
        "DeepSeek-R1": 50.0,
        "DeepSeek-R1-Distill-Qwen-14B": 0.0,
        "DeepSeek-R1-Distill-Llama-70B": 0.0,
        "DeepSeek-R1-Distill-Qwen-1.5B": 0.0,
        "gpt-4o": 0.0,
        "claude-3.5-sonnet": 0.0
    },
    {
        "question": 8,
        "o3-mini": 100.0,
        "o1": 50.0,
        "DeepSeek-R1": 100.0,
        "DeepSeek-R1-Distill-Qwen-14B": 75.0,
        "DeepSeek-R1-Distill-Llama-70B": 50.0,
        "DeepSeek-R1-Distill-Qwen-1.5B": 50.0,
        "gpt-4o": 0.0,
        "claude-3.5-sonnet": 0.0
    },
    {
        "question": 9,
        "o3-mini": 100.0,
        "o1": 75.0,
        "DeepSeek-R1": 75.0,
        "DeepSeek-R1-Distill-Qwen-14B": 50.0,
        "DeepSeek-R1-Distill-Llama-70B": 50.0,
        "DeepSeek-R1-Distill-Qwen-1.5B": 0.0,
        "gpt-4o": 75.0,
        "claude-3.5-sonnet": 25.0
    },
    {
        "question": 10,
        "o3-mini": 75.0,
        "o1": 100.0,
        "DeepSeek-R1": 25.0,
        "DeepSeek-R1-Distill-Qwen-14B": 0.0,
        "DeepSeek-R1-Distill-Llama-70B": 0.0,
        "DeepSeek-R1-Distill-Qwen-1.5B": 0.0,
        "gpt-4o": 0.0,
        "claude-3.5-sonnet": 0.0
    },
    {
        "question": 11,
        "o3-mini": 100.0,
        "o1": 100.0,
        "DeepSeek-R1": 25.0,
        "DeepSeek-R1-Distill-Qwen-14B": 0.0,
        "DeepSeek-R1-Distill-Llama-70B": 25.0,
        "DeepSeek-R1-Distill-Qwen-1.5B": 0.0,
        "gpt-4o": 0.0,
        "claude-3.5-sonnet": 0.0
    },
    {
        "question": 12,
        "o3-mini": 100.0,
        "o1": 100.0,
        "DeepSeek-R1": 100.0,
        "DeepSeek-R1-Distill-Qwen-14B": 75.0,
        "DeepSeek-R1-Distill-Llama-70B": 100.0,
        "DeepSeek-R1-Distill-Qwen-1.5B": 0.0,
        "gpt-4o": 0.0,
        "claude-3.5-sonnet": 0.0
    },
    {
        "question": 13,
        "o3-mini": 25.0,
        "o1": 25.0,
        "DeepSeek-R1": 0.0,
        "DeepSeek-R1-Distill-Qwen-14B": 0.0,
        "DeepSeek-R1-Distill-Llama-70B": 0.0,
        "DeepSeek-R1-Distill-Qwen-1.5B": 0.0,
        "gpt-4o": 0.0,
        "claude-3.5-sonnet": 0.0
    },
    {
        "question": 14,
        "o3-mini": 0.0,
        "o1": 25.0,
        "DeepSeek-R1": 0.0,
        "DeepSeek-R1-Distill-Qwen-14B": 0.0,
        "DeepSeek-R1-Distill-Llama-70B": 0.0,
        "DeepSeek-R1-Distill-Qwen-1.5B": 0.0,
        "gpt-4o": 0.0,
        "claude-3.5-sonnet": 0.0
    },
    {
        "question": 15,
        "o3-mini": 0.0,
        "o1": 0.0,
        "DeepSeek-R1": 0.0,
        "DeepSeek-R1-Distill-Qwen-14B": 0.0,
        "DeepSeek-R1-Distill-Llama-70B": 0.0,
        "DeepSeek-R1-Distill-Qwen-1.5B": 0.0,
        "gpt-4o": 0.0,
        "claude-3.5-sonnet": 0.0
    },
    {
        "question": "Avg",
        "o3-mini": 78.33333333333334,
        "o1": 76.66666666666669,
        "DeepSeek-R1": 65.0,
        "DeepSeek-R1-Distill-Qwen-14B": 50.00000000000001,
        "DeepSeek-R1-Distill-Llama-70B": 50.0,
        "DeepSeek-R1-Distill-Qwen-1.5B": 25.0,
        "gpt-4o": 13.333333333333334,
        "claude-3.5-sonnet": 3.3333333333333335
    },
    {
        "question": "Cost",
        "o3-mini": 3.3047915999999997,
        "o1": 42.47478,
        "DeepSeek-R1": 4.90553,
        "DeepSeek-R1-Distill-Qwen-14B": 1.1507616,
        "DeepSeek-R1-Distill-Llama-70B": 1.3534620000000002,
        "DeepSeek-R1-Distill-Qwen-1.5B": 0.1600641,
        "gpt-4o": 0.5545100000000001,
        "claude-3.5-sonnet": 0.534252
    }
]

$(document).ready(function() {
    // Check for click events on the navbar burger icon

    var options = {
			slidesToScroll: 1,
			slidesToShow: 1,
			loop: true,
			infinite: true,
			autoplay: true,
			autoplaySpeed: 5000,
    }

		// Initialize all div with carousel class
    var carousels = bulmaCarousel.attach('.carousel', options);
	
    bulmaSlider.attach();
	
	// round to 2 decimal places
	for (var i = 0; i < result_data.length; i++) {
		for (var key in result_data[i]) {
			if (key == "question") {
				continue;
			}
			if (i >= 15) {
				result_data[i][key] = Math.round(result_data[i][key] * 100) / 100;
			} else {
				result_data[i][key] = Math.round(result_data[i][key]);
			}
		}
	}

	var transposed_data = [];

	var model_names = [];
	// get all keys except question
	for (var key in result_data[0]) {
		if (key == "question") {
			continue;
		}
		if (!model_names.includes(key)) {
			model_names.push(key);
			transposed_data.push({"model_name": key});
		}
	}

	for (var i = 0; i < result_data.length; i++) {
		var row = result_data[i];
		for (var key in row) {
			if (key == "question") {
				continue;
			}
			var j = model_names.indexOf(key);
			transposed_data[j][row['question']] = row[key];
		}
	}
	var table = $('#myTopTable').DataTable({
		"data": transposed_data,
		"columns": [
	        { "data": "model_name",
              "render": function(data, type, row, meta){
                // Render the model name as a clickable link
                return '<a id="' + data + '" onclick=captureModelName("'+ data +'")>'+ data +'</a>';
                } 
            },  
			{ "data": "Avg" },
			{ "data": "Cost" },
			{ "data": "1" },
			{ "data": "2" },
			{ "data": "3" },
			{ "data": "4" },
			{ "data": "5" },
			{ "data": "6" },
			{ "data": "7" },
			{ "data": "8" },
			{ "data": "9" },
			{ "data": "10" },
			{ "data": "11" },
			{ "data": "12" },
			{ "data": "13" },
			{ "data": "14" },
			{ "data": "15" },
			
	    ],
		"pageLength": 17,
		"order": [],
		"fixedColumns": true,
		"scrollX": true,
		"lengthChange": false,
		"info": false,  // Disable the info text
		"searching": false,  // Disable the search box
		"paging": false,  // Disable the pagination
		"ordering": false,  // Disable the sorting
		// remove alternating row colors
		"stripeClasses": [],
		"columnDefs": [
			{
				"targets": [3,4,5,6,7,8,9,10,11,12,13,14,15,16,17],
				"createdCell": function (td, cellData, rowData, row, col) {
					var pValue = parseFloat(cellData);
					var color = getColor(pValue);
					$(td).css('background-color', color);
					// if the target is <= 15, then remove the text
					$(td).text("");
				}
			},
			{
				"targets": [1,2],
				"createdCell": function (td, cellData, rowData, row, col) {
					var pValue = parseFloat(cellData);
					// if the target is <= 15, then remove the text
					var string = pValue.toFixed(2).toString();
					if (col == 2) {
						string = '$' + string;
					}
					if (col == 1) {
						string = string + '%';
					}
					if (string.length < 6) {
						// Add a non-breaking space (invisible but retains width)
						string = '\u00A0' + '\u00A0' + string;
					}
					$(td).text(string);
					
				}
			},
			{ width: '20%', targets: 0, className: 'model-names' },
			// set font size of last two columns
			{ width: '5%', targets: 1, className: 'avg-cost' },
			{ width: '5%', targets: 2, className: 'avg-cost' },
		],
	});
	table.columns.adjust().draw();

})

function getColor(value) {
	var red = 255;
	var green = 255;
	// define 5 color levels, 0-20, 20-40, 40-60, 60-80, 80-100
	// give the same color for the same level
	if (value > 75) {
		red = 0;
		green = 255;
	} else if (value >= 25) {
		red = 255;
		green = 255;
	} else {
		red = 255;
		green = 0;
	}


	// if (value >= 50) {
	// 	green = 255;
	// 	red = 255 - (255 / 50 * value - 255);
	// } else {
	// 	green = (255 / 50 * value);
	// 	red = 255;
	// }
	return 'rgba(' + red + ',' + green + ',0,0.2)';
}

function captureTask(task) {
    var table = $('#myTopTable').DataTable();
    var as = table.table().container().querySelectorAll("a");

    for (var i = 0; i < as.length; i++) {
        // find <a> element as a child of ths[i] 
        if (as[i].id == window.currTask) {
            as[i].style.color = "black";
        }
        if (as[i].id == task) {
            as[i].style.color = "orange";
        }
    }

    window.currTask = task; 
    if (window.currModelName) {
        updateTraces(window.currModelName, task);
        document.getElementById("traces").style.display = "block";
    }
}

function captureModelName(modelName) {
    var table = $('#myTopTable').DataTable();
    var as = table.table().container().querySelectorAll("a");

    for (var i = 0; i < as.length; i++) {
        // find <a> element as a child of ths[i] 
        if (as[i].id == window.currModelName) {
            as[i].style.color = "inherit"
        }
        if (as[i].id == modelName) {
            as[i].style.color = "orange"
        }
    }

    window.currModelName = modelName;
    // if currTask exists show the interactions element 
    if (window.currTask) {
        updateTraces(modelName, window.currTask);
        document.getElementById("traces").style.display = "block";
    }

}

function updateTraces(modelName, task) {
    console.log("Updating traces for model: " + modelName + " and task: " + task);
    var header = document.createElement("h3");
    header.innerHTML = modelName + " - " + task + traces[task].statement;
    document.getElementById("traces").appendChild(header);
}
